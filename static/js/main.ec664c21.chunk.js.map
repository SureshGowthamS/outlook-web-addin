{"version":3,"sources":["index.js"],"names":["Office","window","App","props","_this","Object","_Users_suresh_Projects_React_outlooktutorial_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_Users_suresh_Projects_React_outlooktutorial_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_suresh_Projects_React_outlooktutorial_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","initialize","initData","state","data","desktopmessagereadmode","api","code","component","language","_this2","readMode","undefined","context","mailbox","item","displayReplyAllForm","newState","itemType","MailboxEnums","ItemType","Message","desktopmessagecomposemode","desktopcalendarreadmode","desktopcalendarcomposemode","setState","addHandlerAsync","EventType","ItemChanged","handleOnItemChange","newAPI","newCode","newComponent","keys","handleOnItemDataChange","element","document","createElement","innerHTML","JSON","stringify","err","message","console","log","eval","_this3","react__WEBPACK_IMPORTED_MODULE_5___default","a","className","Title","apis","components","onAPIChange","handleOnAPIChange","onComponentChange","handleOnComponentChange","Editor","onChange","handleOnCodeChange","Console","Actions","onRunCode","handleOnRunCode","onPersistent","handleOnPersistentEvent","React","Component","_this4","componentOptions","forEach","option","index","push","key","value","apiOptions","event","target","_this5","editor","_this6","focus","addEventListener","handleResize","layout","newValue","_this7","react_monaco_editor_lib_editor__WEBPACK_IMPORTED_MODULE_7___default","theme","options","minimap","enabled","lineNumbersMinChars","autoIndent","formatOnPaste","formatOnType","folding","handleOnChange","editorDidMount","monaco","_this8","onClick","handleOnPersistent","_this9","visible","handleOnMessage","newMessage","toString","_this10","handleOnClose","render","getElementById"],"mappings":"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","file":"static/js/main.ec664c21.chunk.js","sourcesContent":["import React from 'react';\nimport {render} from 'react-dom';\nimport MonacoEditor from 'react-monaco-editor/lib/editor';\nimport * as desktopmessagereadmode from './desktopmessagereadmode.json';\nimport * as desktopmessagecomposemode from './desktopmessagecomposemode.json';\nimport * as desktopcalendarreadmode from './desktopcalendarreadmode.json';\nimport * as desktopcalendarcomposemode from './desktopcalendarcomposemode.json';\nimport './index.css';\nconst Office = window.Office;\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        Office.initialize = () =>this.initData(); \n        this.state = {\n            data : desktopmessagereadmode,\n            api: \"displayLanguage\",\n            code: \"console.log(Office.context.displayLanguage);\",\n            component: \"Office.context\",\n            language: \"javascript\"\n        }\n    }\n\n    initData() {\n        const readMode = (Office.context.mailbox.item.displayReplyAllForm !== undefined);\n        var newData = this.state.data;\n        if (Office.context.mailbox.item.itemType === Office.MailboxEnums.ItemType.Message) {\n            newData = readMode ? desktopmessagereadmode : desktopmessagecomposemode;\n        } else {\n            newData = readMode ? desktopcalendarreadmode : desktopcalendarcomposemode;\n        } \n        const newState = {\n            data: newData,\n            language: this.state.language,\n            code: this.state.code,\n            api: this.state.api,\n            component: this.state.component\n        };\n        this.setState(newState);\n        Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, () => this.handleOnItemChange());\n    }\n\n    handleOnAPIChange(newAPI) {\n        const newCode = this.state.data[\"default\"][this.state.component][newAPI];\n        const newState = {\n            data: this.state.data,\n            language: \"javascript\",\n            code: newCode,\n            api: newAPI,\n            component: this.state.component\n        };\n        this.setState(newState);\n    }\n\n    handleOnCodeChange(newCode) {\n        const newState = {\n            data: this.state.data,\n            language: \"javascript\",\n            code: newCode,\n            api: this.state.api,\n            component: this.state.component\n        };\n        this.setState(newState);\n    }\n\n    handleOnComponentChange(newComponent) {\n        const newAPI = Object.keys(this.state.data[\"default\"][newComponent])[0];\n        const newCode = this.state.data[\"default\"][newComponent][newAPI];\n        const newState = {\n            data: this.state.data,\n            language: \"javascript\",\n            code: newCode,\n            api: newAPI,\n            component: newComponent\n        };\n        this.setState(newState);\n    }\n\n    handleOnItemChange() {\n        if (this.state.language === \"json\") {\n            this.handleOnItemDataChange();\n        }\n    }\n\n    handleOnItemDataChange() {\n        var newCode = \"\";\n        try {\n            var element = document.createElement(\"pre\");\n            element.innerHTML = JSON.stringify(Office.context.mailbox.item, null , 4);\n            newCode = element.innerHTML;\n        } catch(err) {\n            newCode = err.message;\n        }\n        const newState = {\n            data: this.state.data,\n            language: \"json\",\n            code: newCode,\n            api: this.state.api,\n            component: this.state.component\n        };\n        this.setState(newState);\n    }\n\n    handleOnPersistentEvent() {\n        console.log(\"Pin the add-in and switch mail items to view all properties\");\n        this.handleOnItemDataChange();\n    }\n\n    handleOnRunCode() {\n        try {\n            eval(this.state.code);\n        }\n        catch (err) {\n            console.log(err.message);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"app\">\n                <Title\n                    api={this.state.api}\n                    component={this.state.component}\n                    apis={Object.keys(this.state.data[\"default\"][this.state.component])}\n                    components={Object.keys(this.state.data[\"default\"])}\n                    onAPIChange={(newAPI) => this.handleOnAPIChange(newAPI)}\n                    onComponentChange={(newComponent) => this.handleOnComponentChange(newComponent)} />\n                <Editor\n                    language={this.state.language}\n                    code={this.state.code}\n                    onChange={(newCode) => this.handleOnCodeChange(newCode)} />\n                <Console />\n                <Actions\n                    onRunCode={() => this.handleOnRunCode()}\n                    onPersistent={() => this.handleOnPersistentEvent()}\n                />\n            </div>\n        );\n    }\n}\n\nclass Title extends React.Component {\n\n    handleOnAPIChange(newAPI) {\n        if (this.props && this.props.onAPIChange) {\n            this.props.onAPIChange(newAPI);\n        }\n    }\n\n    handleOnComponentChange(newComponent) {\n        if (this.props && this.props.onComponentChange) {\n            this.props.onComponentChange(newComponent);\n        }\n    }\n\n    render() {\n        var componentOptions = [];\n        if (this.props && this.props.components) {\n            this.props.components.forEach((option, index) => {\n                componentOptions.push(<option key={index} value={option}>{option}</option>);\n            });\n        }\n        var apiOptions = [];\n        if (this.props && this.props.apis) {\n            this.props.apis.forEach((option, index) => {\n                apiOptions.push(<option key={index} value={option}>{option}</option>);\n            });\n        }\n        return (\n            <div className=\"title\">\n                <select className=\"components\" value={this.props.component} onChange={(event) => this.handleOnComponentChange(event.target.value)}>\n                    {componentOptions}\n                </select>\n                <br />\n                <select className=\"apis\" value={this.props.api} onChange={(event) => this.handleOnAPIChange(event.target.value)}>\n                    {apiOptions}\n                </select>\n            </div>\n        );\n    }\n}\n\nclass Editor extends React.Component {\n    constructor(props) {\n        super(props);\n        this.editor = null;\n    }\n    editorDidMount(editor) {\n        editor.focus();\n        this.editor = editor;\n        window.addEventListener('resize', () => this.handleResize());\n    }\n\n    handleResize() {\n        this.editor.layout();\n    }\n\n    handleOnChange(newValue) {\n        if (this.props && this.props.onChange) {\n            this.props.onChange(newValue);\n        }\n    }\n\n    render() {\n        const code = (this.props && this.props.code) ? this.props.code : '// type your code...';\n        const options = {\n            minimap: {\n                enabled: false\n            },\n            lineNumbersMinChars: 2,\n            autoIndent: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            folding: false\n        };\n        return (\n            <div className=\"editor\">\n                <MonacoEditor\n                    language={this.props.language}\n                    theme=\"vs-light\"\n                    options={options}\n                    value={code}\n                    onChange={(newValue) => this.handleOnChange(newValue)}\n                    editorDidMount={(editor, monaco) => this.editorDidMount(editor)}\n                />\n            </div>\n        );\n    }\n}\n\nclass Actions extends React.Component {\n    handleOnRunCode() {\n        if (this.props && this.props.onRunCode) {\n            this.props.onRunCode();\n        }\n    }\n\n    handleOnPersistent() {\n        if (this.props && this.props.onPersistent) {\n            this.props.onPersistent();\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"actions\">\n                <button onClick={() => this.handleOnRunCode()}>Run code</button>\n                <button onClick={() => this.handleOnPersistent()}>All Properties</button>\n            </div>\n        );\n    }\n}\n\nclass Console extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            visible: false,\n            message: \"\"\n        };\n        console.log = (message) => this.handleOnMessage(message);\n    }\n\n    handleOnClose() {\n        const newState = {\n            visible: false,\n            message: \"\"\n        };\n        this.setState(newState);\n    }\n\n    handleOnMessage(newMessage) {\n        if (newMessage === undefined) {\n            newMessage = \"undefined\";\n        } else {\n            newMessage = newMessage.toString();\n        }\n        const newState = {\n            visible: true,\n            message: newMessage\n        };\n        this.setState(newState);\n    }\n\n    render() {\n        const element = this.state.visible ?\n            (<div className=\"console\">\n                <div>{this.state.message}</div>\n                <button className=\"closeButton\" onClick={() => this.handleOnClose()}>X</button>\n            </div>)\n            : null;\n        return (element);\n    }\n}\nrender(<App />, document.getElementById('app'));\n\n"],"sourceRoot":""}